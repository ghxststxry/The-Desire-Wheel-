
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<title>The Desire Wheel üî•</title>
<style>
  :root{
    --bg:#0f0f12;
    --panel:#141417;
    --accent:#ea4a61;
    --accent-2:#ff9dad;
    --text:#f4f4f7;
    --muted:#cfcfd6;
    --line:rgba(255,255,255,.10);
  }
  html,body{height:100%}
  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
  body{
    margin:0; color:var(--text);
    font-family: ui-rounded, system-ui, -apple-system, "SF Pro Rounded", "Nunito", "Segoe UI", Roboto, Arial, sans-serif;
    min-height:100dvh;
    background: linear-gradient(180deg, #0b0b0d, var(--bg));
    padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right))
             max(16px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
    display:grid; place-items:center;
  }

  .shell{ width:min(900px,100%); background:linear-gradient(180deg, var(--panel), #111113);
    border-radius:20px; overflow:hidden; position:relative; box-shadow:0 20px 50px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  header{ display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:12px 14px; border-bottom:1px solid var(--line); background:rgba(255,255,255,.02); }
  .brand{ display:flex; align-items:center; gap:10px; font-weight:900; letter-spacing:.2px; font-size:17px }
  .heart-logo{ width:24px; height:24px; display:grid; place-items:center; border-radius:8px;
    background:radial-gradient(90% 90% at 50% 30%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%);
    box-shadow:0 8px 18px rgba(234,74,97,.25); }
  .meta{ color:var(--muted); font-size:12px }

  .stage{ position:relative; display:grid; grid-template-rows: 1fr auto auto; min-height:58vh; background:#121214; overflow:hidden; }
  .viewer{ position:relative; z-index:1; display:grid; place-items:center; padding:12px; }
  #display{ max-width:94%; max-height:58vh; border-radius:14px; object-fit:contain;
    box-shadow: 0 12px 28px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  .thumbs{ z-index:1; display:grid; grid-auto-flow:column; grid-auto-columns:80px; gap:8px; overflow-x:auto; padding:8px 10px; border-top:1px solid var(--line); background:#111114 }
  .thumbs img{ width:100%; height:60px; object-fit:cover; border-radius:10px; border:1px solid var(--line); cursor:pointer; }
  .slot{ z-index:1; position:relative; display:grid; place-items:center; padding:12px; border-top:1px solid var(--line); background:rgba(255,255,255,.02); }
  .spin{ appearance:none; border:none; cursor:pointer; font-weight:1000; letter-spacing:.2px; font-size:17px; color:#2b0208; padding:12px 18px; border-radius:999px;
    background: radial-gradient(120% 140% at 50% 20%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%); box-shadow: 0 12px 26px rgba(234,74,97,.35), 0 3px 0 rgba(0,0,0,.25) inset; }
  .spin:active{ transform: translateY(1px) scale(.98) }

  /* Hearts from button */
  .btn-particles{ position:absolute; left:50%; transform:translateX(-50%); bottom:10px; pointer-events:none; }
  .heartParticle{ position:absolute; left:0; bottom:0; font-size:14px; opacity:0; animation: rise 1.2s ease-out forwards; }
  @keyframes rise{
    0%{ transform: translate(-50%, 0) scale(.7); opacity:0 }
    10%{ opacity:1 }
    100%{ transform: translate(calc(-50% + var(--dx)), -110px) scale(1.15); opacity:0 }
  }

  /* Flash on stop */
  .flash{ position:absolute; inset:0; z-index:2; pointer-events:none; background: radial-gradient(600px 400px at 50% 50%, rgba(255,255,255,.45), transparent 60%); opacity:0; transition: opacity .28s ease; }
  .flash.show{ opacity:1 }

  /* Fire confetti */
  .fire{ position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:3; overflow:hidden; }
  .ember{ position:absolute; font-size:18px; animation: blaze 900ms ease-out forwards; }
  @keyframes blaze{
    0%{ transform: translate(var(--x), var(--y)) scale(.8) rotate(0deg); opacity:0 }
    10%{ opacity:1 }
    100%{ transform: translate(calc(var(--x) + var(--dx)), calc(var(--y) - 160px)) scale(1.2) rotate(15deg); opacity:0 }
  }

  /* Reveal cue */
  .reveal{ animation: reveal .5s cubic-bezier(.2,.8,.1,1) }
  @keyframes reveal{ 0%{ transform: scale(.98); filter: blur(6px) brightness(.95); opacity:0 } 100%{ transform: scale(1); filter:none; opacity:1 } }

  /* Intro splash */
  .intro{ position: fixed; inset: 0; z-index: 100; display:grid; place-items:center;
    background: radial-gradient(1400px 900px at 50% -10%, rgba(234,74,97,.18), transparent 60%), linear-gradient(180deg, #0b0b0d, #16161a); }
  .intro-card{ text-align:center; max-width: 640px; padding: 28px 20px; border-radius: 16px;
    background: rgba(255,255,255,.02); border:1px solid var(--line); box-shadow: 0 16px 40px rgba(0,0,0,.5); }
  .intro h1{ margin:0 0 10px; font-size: 26px; letter-spacing:.2px }
  .intro p{ margin: 10px auto 0; color: var(--muted); font-size: 15px; line-height:1.6; max-width: 520px; }
  .intro .cta{ margin-top: 14px }
  .intro .start{ appearance:none; border:none; cursor:pointer; font-weight:1000; letter-spacing:.2px; font-size:16px; color:#2b0208;
    padding:12px 18px; border-radius:999px; background: radial-gradient(120% 140% at 50% 20%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%); box-shadow: 0 12px 26px rgba(234,74,97,.35), 0 3px 0 rgba(0,0,0,.25) inset; }
  .fade-out{ animation: fadeout .35s ease forwards }
  @keyframes fadeout{ to{ opacity:0; visibility:hidden } }
</style>
</head>
<body>
  <div class="shell" role="application" aria-label="The Desire Wheel">
    <header>
      <div class="brand"><span class="heart-logo">üíñ</span><span>The Desire Wheel üî•</span></div>
      <div class="meta"><span id="count">0</span> photos ‚Ä¢ tap SPIN</div>
    </header>

    <!-- Intro splash -->
    <div class="intro" id="intro">
      <div class="intro-card">
        <h1>The Desire Wheel üî•</h1>
        <p>
          A hot, funny gamble with ideas-as-photos. Spin to reveal the next spark.
          Remember: sometimes <em>one's position in society</em> makes all the difference ‚Äî
          but here, the wheel treats every idea like royalty. üòâ
        </p>
        <div class="cta">
          <button class="start" id="startBtn">Begin</button>
        </div>
      </div>
    </div>

    <section class="stage">
      <div class="viewer">
        <img id="display" alt="current" />
        <div class="flash" id="flash"></div>
        <div class="fire" id="fire"></div>
      </div>
      <div class="slot">
        <button id="spinBtn" class="spin">‚ù§Ô∏è SPIN</button>
        <div class="btn-particles" id="btnParticles"></div>
      </div>
      <div id="thumbs" class="thumbs" aria-label="All photos"></div>
    </section>
  </div>

<script>
const PHOTOS = ['https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlelPq1MnQRrudLO_Om5pbh37IRGneS2WcC8pq8ngu5w&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlEsFq4_xS7MEP9LSBz0XwYXQtQOe4vLaNJztVirA0_Q&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTK2gRcN39Tbi2SspzsIPSA0l6kAujkCjeBhltBlSLWA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAnWtH7JyrABt492qToLsDyAqYWMCQiCPSpDwmBDtfLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQWsRYDhJlDmP3L-niG8n52AgLfwS1BZWJ5JMbl4yUpBg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS9hh_LiZwvT8ujeKffuX4g0N23v4qyRYU9Hbc0gvH-tg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT7QYw6vPc2sdSYAL5a9POmfYxlaACIxnkSM6y9WKmt0g&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBDPRgL1YfBSWFJSR9o8J0UU8i6EgKueMQI1ugbzw1Ag&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAKANGe5Oyfo3Y8L3klKG6PVBAVTGC6hOzVhTEWLJcUQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZ-666QIo6VkbJFFxPv_ZgT103wGk3bx5YyCY-vmoNpA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnrnaGo7Lbi9dJufeZsWiGlRCfRyCWnD3crkR4pdT_Aw&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYzEa0302dL1rk48nKzds9XpSQPNaYLhFJbxLvep9FLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSiY6eUFo7uTWRD7OpXNZTw2-r_mgK9OGxwHGngykgpDQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSJSf41wuNGeORcuOJ4bGR3vNx3002HuGd4GOCsYzrozw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcHdTTNYIQrrmnGBG-6_aj_rFYSvN4MeZ9AZkHx6Ghtg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOadkdb31_at6swnlVpCvl-c11SoUpyj9OsZBroEV1dw&s=10'];

const display = document.getElementById('display');
const thumbs = document.getElementById('thumbs');
const spinBtn = document.getElementById('spinBtn');
const countEl = document.getElementById('count');
const flashEl = document.getElementById('flash');
const fireLayer = document.getElementById('fire');
const btnParticles = document.getElementById('btnParticles');
const intro = document.getElementById('intro');
const startBtn = document.getElementById('startBtn');

let current = -1;
let spinning = false;
let heartInterval = null;

// Audio (minimal, mobile-friendly)
let actx = null;
function ensureAudio(){
  if (!actx){
    const Ctx = window.AudioContext || window.webkitAudioContext;
    if (Ctx){ actx = new Ctx(); }
  } else if (actx.state === 'suspended'){
    actx.resume();
  }
  return actx;
}
function clickSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'triangle'; o.frequency.value = 420;
  g.gain.value = 0.001; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.02, t+0.02);
  o.frequency.exponentialRampToValueAtTime(200, t+0.10);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.12);
  o.stop(t+0.13);
}
function tickSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'square'; o.frequency.value = 880;
  g.gain.value = 0.0008; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.015, t+0.01);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.08);
  o.stop(t+0.09);
}
function winSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o1 = ctx.createOscillator(), o2 = ctx.createOscillator();
  const g = ctx.createGain(); g.gain.value = 0.002;
  o1.type='sine'; o2.type='sine'; o1.connect(g); o2.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o1.frequency.setValueAtTime(660, t);
  o2.frequency.setValueAtTime(990, t);
  o1.start(t); o2.start(t);
  o1.frequency.exponentialRampToValueAtTime(440, t+0.25);
  o2.frequency.exponentialRampToValueAtTime(660, t+0.25);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.35);
  o1.stop(t+0.36); o2.stop(t+0.36);
}

// UI
function show(i, animate){
  current = i;
  display.src = PHOTOS[i];
  if (animate){
    display.classList.remove('reveal');
    void display.offsetWidth;
    display.classList.add('reveal');
  }
}

// Hearts from button
function emitHeartsStart(){
  if (heartInterval) return;
  heartInterval = setInterval(()=>{
    const span = document.createElement('span');
    span.className = 'heartParticle';
    span.textContent = 'üíñ';
    const dx = (Math.random()*120 - 60) + 'px';
    span.style.setProperty('--dx', dx);
    span.style.left = (Math.random()*40 - 20) + 'px';
    btnParticles.appendChild(span);
    setTimeout(()=> span.remove(), 1300);
  }, 100);
}
function emitHeartsStop(){
  if (heartInterval){ clearInterval(heartInterval); heartInterval = null; }
}

// Fire confetti
function fireBlast(){
  fireLayer.innerHTML = '';
  const N = 36;
  const rect = display.getBoundingClientRect();
  for(let i=0;i<N;i++){
    const ember = document.createElement('span');
    ember.className = 'ember';
    ember.textContent = 'üî•';
    const x = (Math.random()*100) + '%';
    const y = (40 + Math.random()*30) + '%';
    const dx = (Math.random()*200 - 100) + 'px';
    ember.style.setProperty('--x', x);
    ember.style.setProperty('--y', y);
    ember.style.setProperty('--dx', dx);
    fireLayer.appendChild(ember);
    setTimeout(()=>ember.remove(), 1000);
  }
}

// Spin logic with precise ~5s duration
function spin(){
  if (spinning) return;
  spinning = true;
  clickSound();
  spinBtn.disabled = true;
  emitHeartsStart();

  const total = PHOTOS.length;
  if (!total){ spinning = false; spinBtn.disabled = false; emitHeartsStop(); return; }

  let target = Math.floor(Math.random()*total);
  if (total > 1 && target === current) target = (target + 1) % total;

  const revolutions = 4; // base loops
  const offset = ((target - current - 1 + total) % total) + 1;
  const steps = revolutions*total + offset;

  // Build delays that sum to TARGET ms
  const TARGET = 5000; // 5 seconds
  const minInterval = 35, maxInterval = 260;
  function easeOut(t){ return 1 - Math.pow(1 - t, 3); }
  const delays = [];
  for(let k=1;k<=steps;k++){
    const t = k/steps;
    delays.push(minInterval + (maxInterval - minInterval)*easeOut(t));
  }
  const sum = delays.reduce((a,b)=>a+b,0);
  const scale = TARGET / sum;
  for(let i=0;i<delays.length;i++) delays[i] *= scale;

  let k = 0;
  function advance(){
    const i = (current + 1) % total;
    show(i, false);
    tickSound();
    if (k < steps-1){
      setTimeout(advance, delays[k++]);
    } else {
      // Land
      show(target, true);
      if (navigator.vibrate) navigator.vibrate([10, 60, 10]);
      flashEl.classList.add('show');
      setTimeout(()=>flashEl.classList.remove('show'), 180);
      winSound();
      fireBlast();
      emitHeartsStop();
      spinning = false;
      spinBtn.disabled = false;
    }
  }
  setTimeout(advance, delays[k++]);
}

// Init
function init(){
  countEl.textContent = PHOTOS.length;
  PHOTOS.forEach((src, i)=>{
    const t = new Image();
    t.src = src; t.alt = 'photo '+(i+1);
    t.addEventListener('click', ()=> { if (!spinning) show(i, true); });
    thumbs.appendChild(t);
  });
  show(0, false);
}
spinBtn.addEventListener('click', ()=>{ ensureAudio(); spin(); });
startBtn.addEventListener('click', ()=>{
  ensureAudio();
  intro.classList.add('fade-out');
  setTimeout(()=>{ intro.style.display='none'; }, 360);
});
init();
</script>
</body>
</html>
