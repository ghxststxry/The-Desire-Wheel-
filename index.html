
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<title>The Desire Wheel üî•</title>
<style>
  :root{
    --bg:#0f0f12;
    --panel:#141417;
    --accent:#ea4a61;
    --accent-2:#ff9dad;
    --text:#f4f4f7;
    --muted:#cfcfd6;
    --line:rgba(255,255,255,.10);
    --frame: clamp(260px, 80vw, 340px);
  }
  html,body{height:100%}
  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
  body{
    margin:0; color:var(--text);
    font-family: ui-rounded, system-ui, -apple-system, "SF Pro Rounded", "Nunito", "Segoe UI", Roboto, Arial, sans-serif;
    min-height:100dvh;
    background: linear-gradient(180deg, #0b0b0d, var(--bg));
    padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right))
             max(16px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
    display:grid; place-items:center;
  }

  .shell{ width:min(900px,100%); background:linear-gradient(180deg, var(--panel), #111113);
    border-radius:20px; overflow:hidden; position:relative; box-shadow:0 20px 50px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  header{ display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:12px 14px; border-bottom:1px solid var(--line); background:rgba(255,255,255,.02); }
  .brand{ display:flex; align-items:center; gap:10px; font-weight:900; letter-spacing:.2px; font-size:17px }
  .heart-logo{ width:24px; height:24px; display:grid; place-items:center; border-radius:8px;
    background:radial-gradient(90% 90% at 50% 30%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%);
    box-shadow:0 8px 18px rgba(234,74,97,.25); }
  .meta{ color:var(--muted); font-size:12px }
  .muter{ appearance:none; border:1px solid var(--line); background:transparent; color:var(--muted);
    border-radius:999px; padding:6px 10px; font-weight:800; cursor:pointer; }
  .muter.active{ color:var(--text); border-color: rgba(255,255,255,.22) }

  .stage{ position:relative; display:grid; grid-template-rows: auto 1fr auto auto; min-height:60vh; background:#121214; overflow:hidden; }
  .title{ z-index:1; text-align:center; font-weight:900; letter-spacing:.2px; padding:10px 10px 0; color:var(--muted) }
  .title .big{ font-size:18px }
  .viewer{ position:relative; z-index:1; display:grid; place-items:center; padding:10px; }
  .frame{ width: var(--frame); height: var(--frame);
    background:#0b0b0d; border-radius:14px; border:1px solid var(--line);
    display:grid; place-items:center;
    box-shadow: 0 12px 28px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  #display{ width:100%; height:100%; object-fit:contain; border-radius:12px; }

  .reaction{ position:absolute; top:8px; right:8px; z-index:2; font-weight:1000; font-size:16px; color:#ffb3c0; opacity:0; transform:translateY(-6px) scale(.96); }
  .reaction.show{ animation: pop 1100ms ease forwards }
  @keyframes pop{
    0%{ opacity:0; transform:translateY(-6px) scale(.96) }
    20%{ opacity:1; transform:translateY(0) scale(1.06) }
    60%{ opacity:1; transform:translateY(0) scale(1) }
    100%{ opacity:0; transform:translateY(-8px) scale(.98) }
  }

  .thumbs{ z-index:1; display:grid; grid-auto-flow:column; grid-auto-columns:74px; gap:8px; overflow-x:auto; padding:8px 10px; border-top:1px solid var(--line); background:#111114 }
  .thumbs img{ width:100%; height:56px; object-fit:cover; border-radius:10px; border:1px solid var(--line); cursor:pointer; }
  .slot{ z-index:1; position:relative; display:grid; place-items:center; padding:10px; border-top:1px solid var(--line); background:rgba(255,255,255,.02); }
  .spin{ appearance:none; border:none; cursor:pointer; font-weight:1000; letter-spacing:.2px; font-size:17px; color:#2b0208; padding:12px 18px; border-radius:999px;
    background: radial-gradient(120% 140% at 50% 20%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%); box-shadow: 0 12px 26px rgba(234,74,97,.35), 0 3px 0 rgba(0,0,0,.25) inset; }
  .spin:active{ transform: translateY(1px) scale(.98) }

  .btn-particles{ position:absolute; left:50%; transform:translateX(-50%); bottom:8px; pointer-events:none; }
  .heartParticle{ position:absolute; left:0; bottom:0; font-size:14px; opacity:0; animation: rise 1.2s ease-out forwards; }
  @keyframes rise{
    0%{ transform: translate(-50%, 0) scale(.7); opacity:0 }
    10%{ opacity:1 }
    100%{ transform: translate(calc(-50% + var(--dx)), -110px) scale(1.15); opacity:0 }
  }

  .flash{ position:absolute; inset:0; z-index:2; pointer-events:none; background: radial-gradient(600px 400px at 50% 50%, rgba(255,255,255,.45), transparent 60%); opacity:0; transition: opacity .28s ease; }
  .flash.show{ opacity:1 }

  .fire{ position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:3; overflow:hidden; }
  .ember{ position:absolute; font-size:18px; animation: blaze 900ms ease-out forwards; }
  @keyframes blaze{
    0%{ transform: translate(var(--x), var(--y)) scale(.8) rotate(0deg); opacity:0 }
    10%{ opacity:1 }
    100%{ transform: translate(calc(var(--x) + var(--dx)), calc(var(--y) - 160px)) scale(1.2) rotate(15deg); opacity:0 }
  }

  .reveal{ animation: reveal .5s cubic-bezier(.2,.8,.1,1) }
  @keyframes reveal{ 0%{ transform: scale(.98); filter: blur(6px) brightness(.95); opacity:0 } 100%{ transform: scale(1); filter:none; opacity:1 } }

  .intro{ position: fixed; inset: 0; z-index: 100; display:grid; place-items:center;
    background: radial-gradient(1400px 900px at 50% -10%, rgba(234,74,97,.18), transparent 60%), linear-gradient(180deg, #0b0b0d, #16161a); }
  .intro-card{ text-align:center; max-width: 640px; padding: 24px 18px; border-radius: 16px;
    background: rgba(255,255,255,.02); border:1px solid var(--line); box-shadow: 0 16px 40px rgba(0,0,0,.5); }
  .intro h1{ margin:0 0 8px; font-size: 24px; letter-spacing:.2px }
  .intro p{ margin: 8px auto 0; color: var(--muted); font-size: 14px; line-height:1.6; max-width: 520px; }
  .intro .cta{ margin-top: 12px }
  .intro .start{ appearance:none; border:none; cursor:pointer; font-weight:1000; letter-spacing:.2px; font-size:15px; color:#2b0208;
    padding:10px 16px; border-radius:999px; background: radial-gradient(120% 140% at 50% 20%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%); box-shadow: 0 12px 26px rgba(234,74,97,.35), 0 3px 0 rgba(0,0,0,.25) inset; }
  .fade-out{ animation: fadeout .35s ease forwards }
  @keyframes fadeout{ to{ opacity:0; visibility:hidden } }
</style>
</head>
<body>
  <div class="shell" role="application" aria-label="The Desire Wheel">
    <header>
      <div class="brand"><span class="heart-logo">üíñ</span><span>The Desire Wheel üî•</span></div>
      <div class="meta"><span id="count">0</span> photos ‚Ä¢ tap SPIN</div>
      <button id="muteBtn" class="muter" aria-pressed="false" title="Toggle music">üîä Music</button>
    </header>

    <!-- Intro splash -->
    <div class="intro" id="intro">
      <div class="intro-card">
        <h1>The Desire Wheel üî•</h1>
        <p>
          Hot, funny, and a tiny bit cheeky. Spin to reveal your next idea.
          Out there, one‚Äôs position in society might change outcomes ‚Äî
          in here, the wheel gives every idea its moment to shine. üòâ
        </p>
        <div class="cta">
          <button class="start" id="startBtn">Begin</button>
        </div>
      </div>
    </div>

    <section class="stage">
      <div class="title"><span class="big" id="titleText">Wait for it‚Ä¶</span></div>
      <div class="viewer">
        <div class="frame">
          <img id="display" alt="current" />
          <div class="reaction" id="reaction"></div>
        </div>
        <div class="flash" id="flash"></div>
        <div class="fire" id="fire"></div>
      </div>
      <div class="slot">
        <button id="spinBtn" class="spin">‚ù§Ô∏è SPIN</button>
        <div class="btn-particles" id="btnParticles"></div>
      </div>
      <div id="thumbs" class="thumbs" aria-label="All photos"></div>
    </section>

    <!-- Background music (provide your own legal MP3/OGG URL) -->
    <audio id="bgm" preload="auto" loop></audio>
  </div>

<script>
const PHOTOS = ['https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlelPq1MnQRrudLO_Om5pbh37IRGneS2WcC8pq8ngu5w&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlEsFq4_xS7MEP9LSBz0XwYXQtQOe4vLaNJztVirA0_Q&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTK2gRcN39Tbi2SspzsIPSA0l6kAujkCjeBhltBlSLWA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAnWtH7JyrABt492qToLsDyAqYWMCQiCPSpDwmBDtfLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQWsRYDhJlDmP3L-niG8n52AgLfwS1BZWJ5JMbl4yUpBg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS9hh_LiZwvT8ujeKffuX4g0N23v4qyRYU9Hbc0gvH-tg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT7QYw6vPc2sdSYAL5a9POmfYxlaACIxnkSM6y9WKmt0g&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBDPRgL1YfBSWFJSR9o8J0UU8i6EgKueMQI1ugbzw1Ag&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAKANGe5Oyfo3Y8L3klKG6PVBAVTGC6hOzVhTEWLJcUQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZ-666QIo6VkbJFFxPv_ZgT103wGk3bx5YyCY-vmoNpA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnrnaGo7Lbi9dJufeZsWiGlRCfRyCWnD3crkR4pdT_Aw&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYzEa0302dL1rk48nKzds9XpSQPNaYLhFJbxLvep9FLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSiY6eUFo7uTWRD7OpXNZTw2-r_mgK9OGxwHGngykgpDQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSJSf41wuNGeORcuOJ4bGR3vNx3002HuGd4GOCsYzrozw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcHdTTNYIQrrmnGBG-6_aj_rFYSvN4MeZ9AZkHx6Ghtg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOadkdb31_at6swnlVpCvl-c11SoUpyj9OsZBroEV1dw&s=10'];
const FUNNY = ["Hot!", "Ohhh no!", "Fansextic!", "Exotic!", "Spicy!", "Saucy!", "Cheeky!", "Steamy!", "Wild!", "Yummy!"];

// ====== BGM CONFIG ======
// Replace with a legally hosted MP3/OGG URL of the track you own rights to.
const BGM_URL = ""; // e.g., "https://your.cdn.com/i-see-red.mp3"
const BGM_START_VOLUME = 0.10; // 10%

const display = document.getElementById('display');
const thumbs = document.getElementById('thumbs');
const spinBtn = document.getElementById('spinBtn');
const countEl = document.getElementById('count');
const flashEl = document.getElementById('flash');
const fireLayer = document.getElementById('fire');
const btnParticles = document.getElementById('btnParticles');
const intro = document.getElementById('intro');
const startBtn = document.getElementById('startBtn');
const titleText = document.getElementById('titleText');
const reaction = document.getElementById('reaction');
const muteBtn = document.getElementById('muteBtn');
const bgm = document.getElementById('bgm');

let current = -1;
let spinning = false;
let heartInterval = null;
let musicReady = false;
let musicMuted = false;

// Setup BGM
function setupBgm(){
  if (!BGM_URL) return;
  if (!bgm.src){ bgm.src = BGM_URL; }
  bgm.volume = BGM_START_VOLUME;
  musicReady = true;
}
function playBgm(){
  if (!BGM_URL) return;
  setupBgm();
  // iOS requires user gesture; this is always called on a button click
  bgm.play().catch(()=>{});
}
function toggleMute(){
  if (!BGM_URL) return;
  musicMuted = !musicMuted;
  bgm.muted = musicMuted;
  muteBtn.setAttribute('aria-pressed', String(!musicMuted ? false : true));
  muteBtn.classList.toggle('active', !musicMuted);
  muteBtn.textContent = musicMuted ? "üîá Music" : "üîä Music";
}

// Audio FX (mobile-friendly) for UI
let actx = null;
function ensureAudioCtx(){
  if (!actx){
    const Ctx = window.AudioContext || window.webkitAudioContext;
    if (Ctx){ actx = new Ctx(); }
  } else if (actx.state === 'suspended'){
    actx.resume();
  }
  return actx;
}
function clickSound(){
  const ctx = ensureAudioCtx(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'triangle'; o.frequency.value = 420;
  g.gain.value = 0.001; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.02, t+0.02);
  o.frequency.exponentialRampToValueAtTime(200, t+0.10);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.12);
  o.stop(t+0.13);
}
function tickSound(){
  const ctx = ensureAudioCtx(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'square'; o.frequency.value = 880;
  g.gain.value = 0.0008; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.015, t+0.01);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.08);
  o.stop(t+0.09);
}
function winSound(){
  const ctx = ensureAudioCtx(); if (!ctx) return;
  const o1 = ctx.createOscillator(), o2 = ctx.createOscillator();
  const g = ctx.createGain(); g.gain.value = 0.002;
  o1.type='sine'; o2.type='sine'; o1.connect(g); o2.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o1.frequency.setValueAtTime(660, t);
  o2.frequency.setValueAtTime(990, t);
  o1.start(t); o2.start(t);
  o1.frequency.exponentialRampToValueAtTime(440, t+0.25);
  o2.frequency.exponentialRampToValueAtTime(660, t+0.25);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.35);
  o1.stop(t+0.36); o2.stop(t+0.36);
}

// UI
function show(i, animate){
  current = i;
  display.src = PHOTOS[i];
  if (animate){
    display.classList.remove('reveal');
    void display.offsetWidth;
    display.classList.add('reveal');
  }
}

// Hearts from button
function emitHeartsStart(){
  if (heartInterval) return;
  heartInterval = setInterval(()=>{
    const span = document.createElement('span');
    span.className = 'heartParticle';
    span.textContent = 'üíñ';
    const dx = (Math.random()*120 - 60) + 'px';
    span.style.setProperty('--dx', dx);
    span.style.left = (Math.random()*40 - 20) + 'px';
    btnParticles.appendChild(span);
    setTimeout(()=> span.remove(), 1300);
  }, 100);
}
function emitHeartsStop(){
  if (heartInterval){ clearInterval(heartInterval); heartInterval = null; }
}

// Fire confetti
function fireBlast(){
  fireLayer.innerHTML = '';
  const N = 36;
  for(let i=0;i<N;i++){
    const ember = document.createElement('span');
    ember.className = 'ember';
    ember.textContent = 'üî•';
    const x = (Math.random()*100) + '%';
    const y = (40 + Math.random()*30) + '%';
    const dx = (Math.random()*200 - 100) + 'px';
    ember.style.setProperty('--x', x);
    ember.style.setProperty('--y', y);
    ember.style.setProperty('--dx', dx);
    fireLayer.appendChild(ember);
    setTimeout(()=>ember.remove(), 1000);
  }
}

// Spin: ~5s, random subset frames, title update + reaction word
function spin(){
  if (spinning) return;
  spinning = true;
  clickSound();
  playBgm(); // start background music on first user spin
  spinBtn.disabled = true;
  emitHeartsStart();
  titleText.textContent = "Wait for it‚Ä¶";

  const total = PHOTOS.length;
  if (!total){ spinning = false; spinBtn.disabled = false; emitHeartsStop(); return; }

  let target = Math.floor(Math.random()*total);
  if (total > 1 && target === current) target = (target + 1) % total;

  const SUBSET_STEPS = 12 + Math.floor(Math.random()*6); // 12-17 frames
  const sequence = [];
  let last = current;
  for(let k=0;k<SUBSET_STEPS-1;k++){
    let i;
    do { i = Math.floor(Math.random()*total); } while(total>1 && i===last);
    sequence.push(i); last = i;
  }
  sequence.push(target);

  const TARGET = 5000;
  const minInterval = 60, maxInterval = 420;
  function easeOut(t){ return 1 - Math.pow(1 - t, 3); }
  const delays = [];
  for(let k=1;k<=sequence.length;k++){
    const t = k/sequence.length;
    delays.push(minInterval + (maxInterval - minInterval)*easeOut(t));
  }
  const sum = delays.reduce((a,b)=>a+b,0);
  const scale = TARGET / sum;
  for(let i=0;i<delays.length;i++) delays[i] *= scale;

  let step = 0;
  function advance(){
    const i = sequence[step];
    show(i, false);
    tickSound();
    step++;
    if (step < sequence.length){
      setTimeout(advance, delays[step-1]);
    } else {
      // Land
      show(target, true);
      if (navigator.vibrate) navigator.vibrate([10, 60, 10]);
      flashEl.classList.add('show');
      setTimeout(()=>flashEl.classList.remove('show'), 180);
      winSound();
      fireBlast();
      emitHeartsStop();
      // reaction word
      const word = FUNNY[Math.floor(Math.random()*FUNNY.length)];
      reaction.textContent = word;
      reaction.classList.remove('show');
      void reaction.offsetWidth;
      reaction.classList.add('show');
      titleText.textContent = word;
      spinning = false;
      spinBtn.disabled = false;
    }
  }
  setTimeout(advance, delays[0]);
}

// Init
function init(){
  countEl.textContent = PHOTOS.length;
  PHOTOS.forEach((src, i)=>{
    const t = new Image();
    t.src = src; t.alt = 'photo '+(i+1);
    t.addEventListener('click', ()=> { if (!spinning) show(i, true); });
    thumbs.appendChild(t);
  });
  show(0, false);
  setupBgm();
}
spinBtn.addEventListener('click', ()=>{ ensureAudioCtx(); spin(); });
startBtn.addEventListener('click', ()=>{
  ensureAudioCtx();
  playBgm(); // start on Begin as well
  intro.classList.add('fade-out');
  setTimeout(()=>{ intro.style.display='none'; }, 360);
});
muteBtn.addEventListener('click', toggleMute);
init();
</script>
</body>
</html>
