
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
<title>The Desire Wheel üî•</title>
<style>
  :root{
    --bg:#0f0f12;
    --panel:#151518;
    --accent:#e8455b;
    --accent-2:#ff9dad;
    --text:#f7f7f9;
    --muted:#d9d9e0;
    --line:rgba(255,255,255,.12);
  }
  html,body{height:100%}
  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
  body{
    margin:0; color:var(--text);
    font-family: ui-rounded, system-ui, -apple-system, "SF Pro Rounded", "Nunito", "Segoe UI", Roboto, Arial, sans-serif;
    min-height:100dvh;
    background: radial-gradient(1200px 800px at 50% -10%, rgba(232,69,91,.12), transparent 60%),
               linear-gradient(180deg, #0b0b0d 0%, var(--bg) 100%);
    padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right))
             max(16px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
    display:grid; place-items:center;
  }
  .shell{ width:min(900px,100%); background:linear-gradient(180deg, var(--panel), #131316);
    border-radius:22px; overflow:hidden; position:relative; box-shadow:0 20px 50px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  header{ display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:12px 14px; border-bottom:1px solid var(--line);
    background:linear-gradient(180deg, rgba(232,69,91,.15), rgba(232,69,91,.06), transparent); }
  .brand{ display:flex; align-items:center; gap:10px; font-weight:900; letter-spacing:.2px; font-size:17px }
  .heart-logo{ width:26px; height:26px; display:grid; place-items:center; border-radius:10px;
    background:radial-gradient(90% 90% at 50% 30%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%);
    box-shadow:0 8px 18px rgba(232,69,91,.35); }
  .meta{ color:var(--muted); font-size:12px }

  .stage{ position:relative; display:grid; grid-template-rows: 1fr auto auto; min-height:58vh; background:linear-gradient(180deg, #121214, #16161a); overflow:hidden; }
  .fx{ position:absolute; inset:0; pointer-events:none; overflow:hidden; z-index:0 }
  .heart{ position:absolute; width:14px; height:14px; opacity:0; animation: float 7s linear infinite }
  @keyframes float{ 0%{opacity:0; transform: translateY(8px) scale(.7) rotate(0)} 10%{opacity:.85} 60%{opacity:.85} 100%{opacity:0; transform: translateY(-110vh) scale(1.15) rotate(18deg)} }

  .viewer{ position:relative; z-index:1; display:grid; place-items:center; padding:12px; }
  #display{ max-width:94%; max-height:58vh; border-radius:16px; object-fit:contain; box-shadow: 0 14px 34px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset; }
  .thumbs{ z-index:1; display:grid; grid-auto-flow:column; grid-auto-columns:88px; gap:8px; overflow-x:auto; padding:8px 10px; border-top:1px solid var(--line); background:#121215 }
  .thumbs img{ width:100%; height:62px; object-fit:cover; border-radius:12px; border:1px solid var(--line); cursor:pointer; }
  .slot{ z-index:1; display:grid; place-items:center; padding:12px; border-top:1px solid var(--line); background: linear-gradient(180deg, rgba(232,69,91,.12), transparent); }
  .spin{ appearance:none; border:none; cursor:pointer; font-weight:1000; letter-spacing:.3px; font-size:18px; color:#2b0208; padding:13px 20px; border-radius:999px;
    background: radial-gradient(120% 140% at 50% 20%, var(--accent-2) 0%, var(--accent) 60%, #b0142c 100%); box-shadow: 0 12px 30px rgba(232,69,91,.45), 0 3px 0 rgba(0,0,0,.25) inset; }
  .spin:active{ transform: translateY(1px) scale(.98) }

  .flash{ position:absolute; inset:0; z-index:2; pointer-events:none; background: radial-gradient(600px 400px at 50% 50%, rgba(255,255,255,.4), transparent 60%); opacity:0; transition: opacity .28s ease; }
  .flash.show{ opacity:1 }
  .reveal{ animation: reveal .55s cubic-bezier(.2,.8,.1,1) }
  @keyframes reveal{ 0%{ transform: scale(.96); filter: blur(8px) brightness(.9); opacity:0 } 100%{ transform: scale(1); filter:none; opacity:1 } }
</style>
</head>
<body>
  <div class="shell" role="application" aria-label="The Desire Wheel">
    <header>
      <div class="brand"><span class="heart-logo">üíñ</span><span>The Desire Wheel üî•</span></div>
      <div class="meta"><span id="count">0</span> photos ‚Ä¢ tap SPIN</div>
    </header>

    <section class="stage">
      <div class="fx" id="fx"></div>
      <div class="viewer">
        <img id="display" alt="current" />
        <div class="flash" id="flash"></div>
      </div>
      <div class="slot"><button id="spinBtn" class="spin">‚ù§Ô∏è SPIN</button></div>
      <div id="thumbs" class="thumbs" aria-label="All photos"></div>
    </section>
  </div>

<script>
const PHOTOS = ['https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlelPq1MnQRrudLO_Om5pbh37IRGneS2WcC8pq8ngu5w&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTlEsFq4_xS7MEP9LSBz0XwYXQtQOe4vLaNJztVirA0_Q&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTK2gRcN39Tbi2SspzsIPSA0l6kAujkCjeBhltBlSLWA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAnWtH7JyrABt492qToLsDyAqYWMCQiCPSpDwmBDtfLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQWsRYDhJlDmP3L-niG8n52AgLfwS1BZWJ5JMbl4yUpBg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS9hh_LiZwvT8ujeKffuX4g0N23v4qyRYU9Hbc0gvH-tg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT7QYw6vPc2sdSYAL5a9POmfYxlaACIxnkSM6y9WKmt0g&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBDPRgL1YfBSWFJSR9o8J0UU8i6EgKueMQI1ugbzw1Ag&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTAKANGe5Oyfo3Y8L3klKG6PVBAVTGC6hOzVhTEWLJcUQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZ-666QIo6VkbJFFxPv_ZgT103wGk3bx5YyCY-vmoNpA&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnrnaGo7Lbi9dJufeZsWiGlRCfRyCWnD3crkR4pdT_Aw&s', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYzEa0302dL1rk48nKzds9XpSQPNaYLhFJbxLvep9FLw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSiY6eUFo7uTWRD7OpXNZTw2-r_mgK9OGxwHGngykgpDQ&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSJSf41wuNGeORcuOJ4bGR3vNx3002HuGd4GOCsYzrozw&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcHdTTNYIQrrmnGBG-6_aj_rFYSvN4MeZ9AZkHx6Ghtg&s=10', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOadkdb31_at6swnlVpCvl-c11SoUpyj9OsZBroEV1dw&s=10'];

const display = document.getElementById('display');
const thumbs = document.getElementById('thumbs');
const spinBtn = document.getElementById('spinBtn');
const countEl = document.getElementById('count');
const fxLayer = document.getElementById('fx');
const flashEl = document.getElementById('flash');

let current = -1;
let spinning = false;

// Hearts background
function spawnHeart(burst=false){
  const span = document.createElement('span');
  span.className = 'heart';
  const size = 12 + Math.random()*16;
  const left = burst ? (40 + Math.random()*20) : (Math.random()*100);
  const delay = Math.random()*4;
  span.style.width = size+'px';
  span.style.height = size+'px';
  span.style.left = left+'%';
  span.style.bottom = burst ? '0px' : '-18px';
  span.style.animationDelay = delay+'s';
  const hue = 350 + Math.random()*20;
  const light = 70 + Math.random()*8;
  span.innerHTML = `<svg viewBox="0 0 24 22" xmlns="http://www.w3.org/2000/svg"><path fill="hsl(${hue} 100% ${light}% / 1)" d="M12 21s-1-.55-2.6-1.67C5.1 16.7 1 13.8 1 9.5 1 6.46 3.46 4 6.5 4 8.24 4 9.82 4.8 11 6.06 12.18 4.8 13.76 4 15.5 4 18.54 4 21 6.46 21 9.5c0 4.3-4.1 7.2-8.4 9.83C13 20.45 12 21 12 21z"/></svg>`;
  fxLayer.appendChild(span);
  setTimeout(()=>span.remove(), 8000);
}
setInterval(()=>{ if (document.hasFocus()) spawnHeart(false); }, 1000);

// Audio
let actx = null;
function ensureAudio(){
  if (!actx){
    const Ctx = window.AudioContext || window.webkitAudioContext;
    if (Ctx){ actx = new Ctx(); }
  } else if (actx.state === 'suspended'){
    actx.resume();
  }
  return actx;
}
function clickSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'triangle'; o.frequency.value = 420;
  g.gain.value = 0.001; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.02, t+0.02);
  o.frequency.exponentialRampToValueAtTime(200, t+0.10);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.12);
  o.stop(t+0.13);
}
function tickSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o = ctx.createOscillator(); const g = ctx.createGain();
  o.type = 'square'; o.frequency.value = 880;
  g.gain.value = 0.0008; o.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o.start(t);
  g.gain.exponentialRampToValueAtTime(0.015, t+0.01);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.08);
  o.stop(t+0.09);
}
function winSound(){
  const ctx = ensureAudio(); if (!ctx) return;
  const o1 = ctx.createOscillator(), o2 = ctx.createOscillator();
  const g = ctx.createGain(); g.gain.value = 0.002;
  o1.type='sine'; o2.type='sine'; o1.connect(g); o2.connect(g); g.connect(ctx.destination);
  const t = ctx.currentTime;
  o1.frequency.setValueAtTime(660, t);
  o2.frequency.setValueAtTime(990, t);
  o1.start(t); o2.start(t);
  o1.frequency.exponentialRampToValueAtTime(440, t+0.25);
  o2.frequency.exponentialRampToValueAtTime(660, t+0.25);
  g.gain.exponentialRampToValueAtTime(0.00001, t+0.35);
  o1.stop(t+0.36); o2.stop(t+0.36);
}

// UI
function show(i, animate){
  current = i;
  display.src = PHOTOS[i];
  if (animate){
    display.classList.remove('reveal');
    void display.offsetWidth;
    display.classList.add('reveal');
  }
}

// Spin logic
function spin(){
  if (spinning) return;
  spinning = true;
  clickSound();
  spinBtn.disabled = true;

  const total = PHOTOS.length;
  if (!total){ spinning = false; spinBtn.disabled = false; return; }

  let target = Math.floor(Math.random()*total);
  if (total > 1 && target === current) target = (target + 1) % total;

  const revolutions = 3 + Math.floor(Math.random()*3);
  const offset = ((target - current - 1 + total) % total) + 1;
  const steps = revolutions*total + offset;

  let k = 0;
  const minInterval = 40, maxInterval = 260;
  function easeOut(t){ return 1 - Math.pow(1 - t, 3); }

  function tick(){
    const i = (current + 1) % total;
    show(i, false);
    tickSound();
    k++;
    const progress = Math.min(1, k/steps);
    const delay = minInterval + (maxInterval - minInterval)*easeOut(progress);
    if (k < steps){
      setTimeout(tick, delay);
    } else {
      show(target, true);
      if (navigator.vibrate) navigator.vibrate([10, 60, 10]);
      flashEl.classList.add('show');
      setTimeout(()=>flashEl.classList.remove('show'), 180);
      winSound();
      for(let j=0;j<8;j++) setTimeout(()=>spawnHeart(true), j*60);
      spinning = false;
      spinBtn.disabled = false;
    }
  }
  tick();
}

// Init
function init(){
  countEl.textContent = PHOTOS.length;
  PHOTOS.forEach((src, i)=>{
    const t = new Image();
    t.src = src; t.alt = 'photo '+(i+1);
    t.addEventListener('click', ()=> { if (!spinning) show(i, true); });
    thumbs.appendChild(t);
  });
  show(0, false);
}
spinBtn.addEventListener('click', ()=>{ ensureAudio(); spin(); });
init();
</script>
</body>
</html>
